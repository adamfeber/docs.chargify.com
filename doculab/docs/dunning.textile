Dunning is the process of how you handle past due accounts.  It involves communicating with your customers in response to failed credit card transactions, and what action you take when the subscription can't be renewed. Chargify gives you the ability to customize these communications.

h2. Configuring your Dunning

Dunning is configured from the "Retries and Dunning" section of the "Settings" tab as shown below.

!/images/doculab/retries-and-dunning-settings.png!

Chargify can send your customers dunning emails on your behalf if you check the appropriate box within the "Dunning Plans" section of the "Settings" page.  These emails will be sent according to the dunning plan you select.

Unless you customize your dunning notifications (see below), these emails will include a link to a Chargify-hosted page that allows the customer to update the card on file.

p(warning). Even if you do not want Chargify to manage your dunning, *you'll still need to select your dunning plan to control automatic cancellation*.

Currently, even if you haven't configured Chargify to send dunning emails on your behalf, we will still respect the "Cancel" action initiated by your selected dunning settings.  In other words, if the dunning plan selected automatically cancels a Subscription 21 days after it transitions to @past_due@ state, we will set the Subscription to @canceled@ state.  So, if you want to manage dunning yourself, you should select the "Never Cancel" strategy and uncheck the appropriate box that instructs us to send emails on your behalf.  Then, you'll want to key off of the @past_due@ state within your own app as to when to start dunning.  If you cancel the subscription yourself, the dunning process will discontinue.

h2. Customizing your dunning notifications

!http://s3.amazonaws.com/entp-tender-production/assets/3ce704345790fdb44ebe1adf78d7e6afbbcf744d/Dock_normal.jpg!

To begin customizing your dunning notification, click on the 'Notifications' tab at the top of the page and then click on the 'Dunning emails' tab on the left.

You can edit the subject and body of the email for each day in your dunning strategy. In addition to the text you specify, you can also include keywords that Chargify will replace dynamically before sending the email. Custom parameters are surrounded in double curly braces like this:  {{custom_parameter}}.

h4. Custom Parameters

|_. Parameter |_. Description |
| failure_subject | The reason the transaction failed. e.g. 'Failed Credit Card Transaction' or 'No Credit Card On File' depending on whether or not the client as a Credit Card on file. |
| from_address | This from address defined for your dunning emails |
| name | The name of your customer. e.g. Bill Williams |
| payment.amount | The amount just paid, formatted in your currency |
| product_price | The recurring price of the subscription's current product |
| product_name | The name of the product. e.g. Basic Plan |
| balance_in_cents | The amount, if any, they still owe. e.g. 0 (for $0.00) or 23100 (for $231.00) Useful for conditionally adding a reminder. |
| balance | The amount, if any, they still owe in dollars. e.g. $0.00 or $2.31 |
| merchant_name | Your merchant name. e.g. Acme Corp. |
| update_url | The URL that the customer can use to update their Credit Card information. |
| masked_card_number | The customer's Credit Card, obscured to only show the last 4 digits.  e.g. XXXX-XXXX-XXXX-1 |
| reason_for_decline | The reason that a transaction was declined at the gateway. |
| payment_profile_exists | This returns 'true' or 'false' depending on whether or not the client as a Credit Card on file. It can be used to conditionally display text based on it's value e.g. <br />  {% if payment_profile_exists %}<br />&nbsp;&nbsp;Lorem Ipsum<br />{% endif %}  |  



For more information on how Dunning works, see: "http://support.chargify.com/faqs/features/what-is-dunning-and-how-does-it-help-me-retain-more-customers":http://support.chargify.com/faqs/features/what-is-dunning-and-how-does-it-help-me-retain-more-customers